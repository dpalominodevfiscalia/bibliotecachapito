@model BibliotecaDB.Models.CompraDetalle

<form asp-action="Create">
    <div asp-validation-summary="ModelOnly" class="text-danger"></div>
    <input type="hidden" asp-for="IdCompra" value="@ViewBag.IdCompra" />

    <div class="form-group">
        <label asp-for="IdProducto" class="control-label">Producto</label>
        <select asp-for="IdProducto" class="form-control" asp-items="ViewBag.IdProducto">
            <option value="">Seleccionar producto</option>
        </select>
        <span asp-validation-for="IdProducto" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label asp-for="Descripcion" class="control-label">Descripci√≥n</label>
        <textarea asp-for="Descripcion" class="form-control" rows="2"></textarea>
        <span asp-validation-for="Descripcion" class="text-danger"></span>
    </div>

    <div class="row">
        <div class="col-md-6">
            <div class="form-group">
                <label asp-for="UnidadMedida" class="control-label">Unidad de Medida</label>
                <select asp-for="UnidadMedida" class="form-control">
                    <option value="">Seleccionar unidad</option>
                    <option value="Unidad">Unidad</option>
                    <option value="Kilogramo">Kilogramo</option>
                    <option value="Litro">Litro</option>
                    <option value="Metro">Metro</option>
                    <option value="Caja">Caja</option>
                    <option value="Paquete">Paquete</option>
                </select>
                <span asp-validation-for="UnidadMedida" class="text-danger"></span>
            </div>
        </div>
        <div class="col-md-6">
            <div class="form-group">
                <label asp-for="CantidadSolicitada" class="control-label">Cantidad Solicitada</label>
                <input asp-for="CantidadSolicitada" class="form-control" type="number" min="1" />
                <span asp-validation-for="CantidadSolicitada" class="text-danger"></span>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-md-6">
            <div class="form-group">
                <label asp-for="CantidadRecibida" class="control-label">Cantidad Recibida</label>
                <input asp-for="CantidadRecibida" class="form-control" type="number" min="0" />
                <span asp-validation-for="CantidadRecibida" class="text-danger"></span>
            </div>
        </div>
        <div class="col-md-6">
            <div class="form-group">
                <label asp-for="PrecioUnitario" class="control-label">Precio Unitario</label>
                <input asp-for="PrecioUnitario" class="form-control" type="number" step="0.01" min="0" />
                <span asp-validation-for="PrecioUnitario" class="text-danger"></span>
            </div>
        </div>
    </div>

    <div class="form-group">
        <label asp-for="TotalParcial" class="control-label">Total Parcial (calculado)</label>
        <input asp-for="TotalParcial" class="form-control" readonly />
        <span asp-validation-for="TotalParcial" class="text-danger"></span>
    </div>

    <div class="modal-footer">
        <input type="submit" value="Guardar" class="btn btn-primary" />
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
    </div>
</form>

@section Scripts {
    <script>
        $(document).ready(function() {
            // Calculate total parcial when quantity or price changes
            $('#CantidadSolicitada, #PrecioUnitario').on('change', function() {
                var cantidad = parseFloat($('#CantidadSolicitada').val()) || 0;
                var precio = parseFloat($('#PrecioUnitario').val()) || 0;
                var total = cantidad * precio;
                $('#TotalParcial').val(total.toFixed(2));
            });
        });
    </script>
}